function [x,w] = lobatto_points(N)
%LOBATTO_POINTS Nodes and weights for Lobatto quadrature integration in [-1,1]
% [x,w] = LOBATTO_POINTS(N) returns the nodes x (in [-1,1]) and weigths w to
% evaluate the integrals using Lobatto quadrature of order N.
% 
% Then, for a continuous function f, its integral over [-1,1] can be
% calculated as sum(F.*w), where F(i) = f(x(i)).

switch N
    case 3
        x = [-1; 0; 1];
        w = [1/3; 4/3; 1/3];
    case 4
        x = [-1; -sqrt(5)/5; sqrt(5)/5; 1];
        w = [1/6; 5/6; 5/6; 1/6];
    case 5
        x = [-1; -sqrt(21)/7; 0; sqrt(21)/7; 1];
        w = [1/10; 49/90; 32/45; 49/90; 1/10];
    case 6
        x = [-1; -sqrt((7+2*sqrt(7))/21); -sqrt((7-2*sqrt(7))/21); sqrt((7-2*sqrt(7))/21); sqrt((7+2*sqrt(7))/21); 1];
        w = [1/15;(14-sqrt(7))/30;(14+sqrt(7))/30; (14+sqrt(7))/30;(14-sqrt(7))/30; 1/15];
    case 7
        x= [-1;
            -0.830224;
            -0.468849;
            0;
            0.468849;
            0.83022;
            1];
        w =[0.0476191;
            0.27683;
            0.431745;
            0.487619;
            0.431745;
            0.27683;
            0.0476191];
    case 9
        x= [-1;
            -0.899758;
            -0.677186;
            -0.363118;
            0;
            0.363118;
            0.677186;
            0.89976;
            1];
        w =[0.0277778;
            0.165495;
            0.274539;
            0.346429;
            0.371519;
            0.34643;
            0.274539;
            0.1655;
            0.0277778];
    case 11
        x =[-1;
            -0.934001;
            -0.784484;
            -0.565235;
            -0.295758;
            0;
            0.29576;
            0.565235;
            0.784484;
            0.934001;
            1];
        w =[0.0181818;
            0.10961;
            0.18717;
            0.248048;
            0.28688;
            0.30022;
            0.28688;
            0.24805;
            0.18717;
            0.10961;
            0.0181818];
    case 13
        x =[-1;
            -0.95331;
            -0.846348;
            -0.686189;
            -0.48291;
            -0.249287;
            0;
            0.249287;
            0.48291;
            0.686189;
            0.846348;
            0.95331;
            1];
        w =[0.0128205;
            0.077802;
            0.134982;
            0.183647;
            0.220768;
            0.244016;
            0.251931;
            0.244016;
            0.220768;
            0.18365;
            0.134982;
            0.0778017;
            0.0128205];
end